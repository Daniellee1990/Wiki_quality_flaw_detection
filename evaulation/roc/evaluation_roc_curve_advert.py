# coding='UTF-8'
import io
import sys
import os
import re
import pandas as pd
import nltk
import nltk.data
import numpy as np
import tensorflow
import keras
from keras import regularizers, optimizers
from keras import backend as K
from keras.callbacks import TensorBoard
from keras.engine.topology import Layer
from keras.models import Model, Sequential
from keras.layers import Input, Dense, LSTM, Bidirectional, Flatten, Dropout, Multiply, Permute, concatenate
from keras.utils import np_utils
from keras.optimizers import Adam
from sklearn import preprocessing
from sklearn.model_selection import train_test_split, StratifiedKFold
from sklearn.metrics import roc_curve, auc

from keras.callbacks import ReduceLROnPlateau
import matplotlib.pyplot as plt

if __name__ == '__main__':
    # roc values get from the training model

    ### Advert  FPR, TPR, auc
    # content+stats bigru
    content_stats_bigru = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.012958963282937365, 0.012958963282937365, 0.017278617710583154, 0.017278617710583154, 0.06479481641468683, 0.06479481641468683, 0.21382289416846653, 0.21382289416846653, 1.0],
                           [0.0, 0.23307291666666666, 0.3854166666666667, 0.45703125, 0.5052083333333334, 0.5390625, 0.5559895833333334, 0.57421875, 0.5911458333333334, 0.6041666666666666, 0.6158854166666666, 0.6236979166666666, 0.6302083333333334, 0.640625, 0.6432291666666666, 0.6536458333333334, 0.6575520833333334, 0.6653645833333334, 0.6692708333333334, 0.6744791666666666, 0.68359375, 0.6888020833333334, 0.6901041666666666, 0.6979166666666666, 0.69921875, 0.703125, 0.7109375, 0.7122395833333334, 0.7174479166666666, 0.7213541666666666, 0.7239583333333334, 0.7291666666666666, 0.7317708333333334, 0.734375, 0.7356770833333334, 0.73828125, 0.7408854166666666, 0.7447916666666666, 0.7473958333333334, 0.75, 0.7552083333333334, 0.7565104166666666, 0.7604166666666666, 0.7708333333333334, 0.7734375, 0.7747395833333334, 0.77734375, 0.7981770833333334, 0.8033854166666666, 0.8072916666666666, 0.8098958333333334, 0.8111979166666666, 0.8138020833333334, 0.8190104166666666, 0.8216145833333334, 0.8268229166666666, 0.8294270833333334, 0.8424479166666666, 0.8450520833333334, 0.9921875, 0.9921875, 0.99609375, 0.99609375, 0.9973958333333334, 0.9973958333333334, 0.9986979166666666, 0.9986979166666666, 1.0, 1.0],
                           [0.9995640973722102]]

    # content bigru
    content_bigru = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0021598272138228943, 0.0021598272138228943, 0.0064794816414686825, 0.0064794816414686825, 0.008639308855291577, 0.008639308855291577, 0.02159827213822894, 0.02159827213822894, 0.028077753779697623, 0.028077753779697623, 0.03455723542116631, 0.03455723542116631, 0.04535637149028078, 0.04535637149028078, 0.06479481641468683, 0.06479481641468683, 1.0],
                     [0.0, 0.0013020833333333333, 0.006510416666666667, 0.009114583333333334, 0.01171875, 0.016927083333333332, 0.020833333333333332, 0.0234375, 0.024739583333333332, 0.028645833333333332, 0.029947916666666668, 0.03515625, 0.036458333333333336, 0.041666666666666664, 0.046875, 0.05078125, 0.053385416666666664, 0.057291666666666664, 0.06510416666666667, 0.06770833333333333, 0.07682291666666667, 0.08072916666666667, 0.08333333333333333, 0.08463541666666667, 0.08984375, 0.09244791666666667, 0.09765625, 0.09895833333333333, 0.10416666666666667, 0.1171875, 0.11979166666666667, 0.12760416666666666, 0.13151041666666666, 0.13671875, 0.14192708333333334, 0.14583333333333334, 0.15104166666666666, 0.15755208333333334, 0.16666666666666666, 0.1875, 0.19140625, 0.19661458333333334, 0.203125, 0.21484375, 0.21875, 0.22526041666666666, 0.23046875, 0.234375, 0.23697916666666666, 0.2421875, 0.2526041666666667, 0.2591145833333333, 0.26953125, 0.2747395833333333, 0.28515625, 0.29296875, 0.2994791666666667, 0.3033854166666667, 0.3059895833333333, 0.31640625, 0.3294270833333333, 0.3346354166666667, 0.34375, 0.35546875, 0.36328125, 0.3697916666666667, 0.3880208333333333, 0.3919270833333333, 0.3932291666666667, 0.4010416666666667, 0.4036458333333333, 0.4166666666666667, 0.4244791666666667, 0.4388020833333333, 0.4466145833333333, 0.4479166666666667, 0.4557291666666667, 0.4622395833333333, 0.4674479166666667, 0.4752604166666667, 0.4765625, 0.5026041666666666, 0.5091145833333334, 0.51171875, 0.5169270833333334, 0.5234375, 0.5286458333333334, 0.53125, 0.5364583333333334, 0.5416666666666666, 0.5481770833333334, 0.55078125, 0.5572916666666666, 0.5598958333333334, 0.5651041666666666, 0.5690104166666666, 0.578125, 0.5794270833333334, 0.5846354166666666, 0.5885416666666666, 0.59375, 0.5950520833333334, 0.6002604166666666, 0.6067708333333334, 0.6080729166666666, 0.6158854166666666, 0.6184895833333334, 0.6236979166666666, 0.625, 0.6354166666666666, 0.6393229166666666, 0.64453125, 0.6484375, 0.6497395833333334, 0.6549479166666666, 0.66015625, 0.6627604166666666, 0.66796875, 0.6705729166666666, 0.6744791666666666, 0.6796875, 0.6822916666666666, 0.6848958333333334, 0.6875, 0.6966145833333334, 0.6979166666666666, 0.7005208333333334, 0.7044270833333334, 0.70703125, 0.7109375, 0.7135416666666666, 0.71484375, 0.7252604166666666, 0.7265625, 0.7317708333333334, 0.7369791666666666, 0.7421875, 0.7447916666666666, 0.7473958333333334, 0.75, 0.7526041666666666, 0.7565104166666666, 0.7591145833333334, 0.76171875, 0.7669270833333334, 0.7734375, 0.7760416666666666, 0.7786458333333334, 0.78125, 0.78515625, 0.7864583333333334, 0.7890625, 0.7903645833333334, 0.79296875, 0.80078125, 0.8033854166666666, 0.8046875, 0.8098958333333334, 0.8216145833333334, 0.82421875, 0.8268229166666666, 0.8294270833333334, 0.8411458333333334, 0.84375, 0.8515625, 0.8541666666666666, 0.8776041666666666, 0.8802083333333334, 0.9518229166666666, 0.9518229166666666, 0.984375, 0.984375, 0.9895833333333334, 0.9895833333333334, 0.9934895833333334, 0.9934895833333334, 0.9947916666666666, 0.9947916666666666, 0.99609375, 0.99609375, 0.9973958333333334, 0.9973958333333334, 0.9986979166666666, 0.9986979166666666, 1.0, 1.0],
                     [0.9996090937724982]]

    # stats dnn
    stats_dnn = [[0.0, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.0064794816414686825, 0.0064794816414686825, 0.008639308855291577, 0.008639308855291577, 0.01079913606911447, 0.01079913606911447, 0.012958963282937365, 0.012958963282937365, 0.01511879049676026, 0.01511879049676026, 0.019438444924406047, 0.019438444924406047, 0.023758099352051837, 0.023758099352051837, 0.032397408207343416, 0.032397408207343416, 0.04319654427645788, 0.04319654427645788, 0.09071274298056156, 0.09071274298056156, 0.4427645788336933, 0.4427645788336933, 1.0],
                 [0.0, 0.022135416666666668, 0.036458333333333336, 0.048177083333333336, 0.0546875, 0.06380208333333333, 0.0703125, 0.07421875, 0.08072916666666667, 0.08463541666666667, 0.09244791666666667, 0.09895833333333333, 0.10416666666666667, 0.11197916666666667, 0.11458333333333333, 0.11979166666666667, 0.12109375, 0.12630208333333334, 0.13151041666666666, 0.13411458333333334, 0.140625, 0.1484375, 0.15494791666666666, 0.16015625, 0.16276041666666666, 0.16796875, 0.17057291666666666, 0.171875, 0.17447916666666666, 0.17578125, 0.1796875, 0.18098958333333334, 0.18489583333333334, 0.1875, 0.19140625, 0.19661458333333334, 0.20182291666666666, 0.20442708333333334, 0.20703125, 0.20963541666666666, 0.21484375, 0.21614583333333334, 0.22395833333333334, 0.22916666666666666, 0.234375, 0.23567708333333334, 0.23828125, 0.24088541666666666, 0.24348958333333334, 0.24609375, 0.24869791666666666, 0.25, 0.2526041666666667, 0.25390625, 0.2565104166666667, 0.26171875, 0.2643229166666667, 0.265625, 0.26953125, 0.2734375, 0.27734375, 0.2825520833333333, 0.2864583333333333, 0.2890625, 0.2903645833333333, 0.3020833333333333, 0.3046875, 0.3098958333333333, 0.3111979166666667, 0.3138020833333333, 0.3177083333333333, 0.3203125, 0.3229166666666667, 0.3268229166666667, 0.3372395833333333, 0.33984375, 0.34375, 0.3489583333333333, 0.3515625, 0.35546875, 0.3567708333333333, 0.359375, 0.36328125, 0.3684895833333333, 0.375, 0.3776041666666667, 0.3919270833333333, 0.39453125, 0.4075520833333333, 0.4127604166666667, 0.41796875, 0.4361979166666667, 0.4388020833333333, 0.4791666666666667, 0.4817708333333333, 0.4895833333333333, 0.4921875, 0.4986979166666667, 0.5013020833333334, 0.5026041666666666, 0.5052083333333334, 0.5130208333333334, 0.515625, 0.5364583333333334, 0.5390625, 0.5533854166666666, 0.5559895833333334, 0.5950520833333334, 0.59765625, 0.6458333333333334, 0.6484375, 0.6940104166666666, 0.6966145833333334, 0.7018229166666666, 0.7044270833333334, 0.7317708333333334, 0.734375, 0.9283854166666666, 0.9283854166666666, 0.9544270833333334, 0.9544270833333334, 0.9739583333333334, 0.9739583333333334, 0.9765625, 0.9765625, 0.9830729166666666, 0.9830729166666666, 0.9869791666666666, 0.9869791666666666, 0.9908854166666666, 0.9908854166666666, 0.9921875, 0.9921875, 0.9947916666666666, 0.9947916666666666, 0.9973958333333334, 0.9973958333333334, 0.9986979166666666, 0.9986979166666666, 1.0, 1.0],
                 [0.9947593255039596]]


    content_stats_bigru_fpr = np.array(content_stats_bigru[0])
    content_stats_bigru_tpr = np.array(content_stats_bigru[1])
    content_stats_bigru_roc_auc = content_stats_bigru[2][0]

    content_bigru_fpr = np.array(content_bigru[0])
    content_bigru_tpr = np.array(content_bigru[1])
    content_bigru_roc_auc = content_bigru[2][0]

    stats_dnn_fpr = np.array(stats_dnn[0])
    stats_dnn_tpr = np.array(stats_dnn[1])
    stats_dnn_roc_auc = stats_dnn[2][0]


    #开始画ROC曲线
    lw = 1.5
    plt.plot(content_stats_bigru_fpr, content_stats_bigru_tpr, 
            color='#FF8C00', linestyle='-', lw=lw, label='Content+stats BiGRU (AUC = %0.4f)'% content_stats_bigru_roc_auc)
    plt.plot(content_bigru_fpr, content_bigru_tpr, 
            color='#A52A2A', linestyle='--', lw=lw,label='Content BiGRU (AUC = %0.4f)'% content_bigru_roc_auc)
    plt.plot(stats_dnn_fpr, stats_dnn_tpr, 
            color='#ADFF2F', linestyle='-', lw=lw,label='Stats DNN (AUC = %0.4f)'% stats_dnn_roc_auc)
    plt.legend(loc='lower right')
    plt.plot([0,1],[0,1],color='#191970', linestyle='--')
    plt.xlim([-0.1,1.1])
    plt.ylim([-0.1,1.1])
    plt.xlabel('False Positive Rate') #横坐标是fpr
    plt.ylabel('True Positive Rate')  #纵坐标是tpr
    plt.title('Receiver operating characteristic')
    plt.show()
