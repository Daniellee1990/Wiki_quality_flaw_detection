# coding='UTF-8'
import io
import sys
import os
import re
import pandas as pd
import nltk
import nltk.data
import numpy as np
import tensorflow
import keras
from keras import regularizers, optimizers
from keras import backend as K
from keras.callbacks import TensorBoard
from keras.engine.topology import Layer
from keras.models import Model, Sequential
from keras.layers import Input, Dense, LSTM, Bidirectional, Flatten, Dropout, Multiply, Permute, concatenate
from keras.utils import np_utils
from keras.optimizers import Adam
from sklearn import preprocessing
from sklearn.model_selection import train_test_split, StratifiedKFold
from sklearn.metrics import roc_curve, auc

from keras.callbacks import ReduceLROnPlateau
import matplotlib.pyplot as plt

if __name__ == '__main__':
    # roc values get from the training model

    ### No footnotes  FPR, TPR, auc
    # content+stats bigru
    content_stats_bigru = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0021598272138228943, 0.0021598272138228943, 0.004319654427645789, 0.004319654427645789, 0.01079913606911447, 0.01079913606911447, 0.012958963282937365, 0.012958963282937365, 0.017278617710583154, 0.017278617710583154, 0.038876889848812095, 0.038876889848812095, 0.04319654427645788, 0.04319654427645788, 0.04967602591792657, 0.04967602591792657, 0.056155507559395246, 0.056155507559395246, 1.0],
                           [0.0, 0.004702194357366771, 0.006269592476489028, 0.0109717868338558, 0.012539184952978056, 0.02037617554858934, 0.02664576802507837, 0.029780564263322883, 0.032915360501567396, 0.03761755485893417, 0.04075235109717868, 0.04231974921630094, 0.045454545454545456, 0.048589341692789965, 0.05172413793103448, 0.05799373040752351, 0.061128526645768025, 0.06269592476489028, 0.06739811912225706, 0.07053291536050156, 0.07366771159874608, 0.07836990595611286, 0.08150470219435736, 0.08307210031347963, 0.08934169278996865, 0.09404388714733543, 0.09717868338557993, 0.0987460815047022, 0.10188087774294671, 0.10501567398119123, 0.109717868338558, 0.11598746081504702, 0.11755485893416928, 0.1238244514106583, 0.12695924764890282, 0.13009404388714735, 0.13322884012539185, 0.13636363636363635, 0.1426332288401254, 0.15203761755485892, 0.1536050156739812, 0.15673981191222572, 0.15987460815047022, 0.164576802507837, 0.1755485893416928, 0.1786833855799373, 0.18181818181818182, 0.18495297805642633, 0.19592476489028213, 0.19905956112852666, 0.20376175548589343, 0.20689655172413793, 0.21003134796238246, 0.21316614420062696, 0.21630094043887146, 0.219435736677116, 0.2225705329153605, 0.22727272727272727, 0.23197492163009403, 0.2335423197492163, 0.23667711598746083, 0.23824451410658307, 0.2445141065830721, 0.25391849529780564, 0.26332288401253917, 0.2664576802507837, 0.27586206896551724, 0.27899686520376177, 0.28056426332288403, 0.2836990595611285, 0.29153605015673983, 0.2946708463949843, 0.2962382445141066, 0.2993730407523511, 0.31504702194357365, 0.3181818181818182, 0.3275862068965517, 0.33072100313479624, 0.335423197492163, 0.34169278996865204, 0.34796238244514105, 0.3542319749216301, 0.3620689655172414, 0.3652037617554859, 0.3981191222570533, 0.4012539184952978, 0.4059561128526646, 0.4090909090909091, 0.41379310344827586, 0.41849529780564265, 0.4200626959247649, 0.4231974921630094, 0.43573667711598746, 0.438871473354232, 0.44357366771159873, 0.5109717868338558, 0.5141065830721003, 0.6802507836990596, 0.6833855799373041, 0.9388714733542319, 0.9388714733542319, 0.9733542319749217, 0.9733542319749217, 0.9858934169278997, 0.9858934169278997, 0.987460815047022, 0.987460815047022, 0.9905956112852664, 0.9905956112852664, 0.9921630094043887, 0.9921630094043887, 0.9952978056426333, 0.9952978056426333, 0.9968652037617555, 0.9968652037617555, 0.9984326018808778, 0.9984326018808778, 1.0, 1.0],
                           [0.9994312680690874]]

    # content bigru
    content_bigru = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0021598272138228943, 0.0021598272138228943, 0.0064794816414686825, 0.0064794816414686825, 0.01079913606911447, 0.01079913606911447, 0.02591792656587473, 0.02591792656587473, 0.032397408207343416, 0.032397408207343416, 0.04967602591792657, 0.04967602591792657, 0.06263498920086392, 0.06263498920086392, 0.06911447084233262, 0.06911447084233262, 0.08423326133909287, 0.08423326133909287, 0.13174946004319654, 0.13174946004319654, 0.39956803455723544, 0.39956803455723544, 0.712742980561555, 0.712742980561555, 1.0],
                     [0.0, 0.001567398119122257, 0.003134796238244514, 0.009404388714733543, 0.017241379310344827, 0.02037617554858934, 0.02821316614420063, 0.032915360501567396, 0.034482758620689655, 0.03761755485893417, 0.04231974921630094, 0.045454545454545456, 0.05172413793103448, 0.05329153605015674, 0.05642633228840126, 0.06896551724137931, 0.07366771159874608, 0.07993730407523511, 0.08463949843260188, 0.09090909090909091, 0.09247648902821316, 0.09561128526645768, 0.09717868338557993, 0.10188087774294671, 0.10344827586206896, 0.109717868338558, 0.11285266457680251, 0.11442006269592477, 0.11755485893416928, 0.11912225705329153, 0.12225705329153605, 0.1238244514106583, 0.12695924764890282, 0.13166144200626959, 0.13636363636363635, 0.13949843260188088, 0.14420062695924765, 0.14576802507836992, 0.14890282131661442, 0.1536050156739812, 0.15517241379310345, 0.164576802507837, 0.16614420062695925, 0.17084639498432602, 0.17398119122257052, 0.17711598746081506, 0.1786833855799373, 0.1833855799373041, 0.18495297805642633, 0.19435736677115986, 0.19592476489028213, 0.19905956112852666, 0.2006269592476489, 0.20376175548589343, 0.2084639498432602, 0.21473354231974923, 0.219435736677116, 0.2225705329153605, 0.22570532915360503, 0.22884012539184953, 0.2304075235109718, 0.2335423197492163, 0.23510971786833856, 0.23981191222570533, 0.24608150470219436, 0.24921630094043887, 0.25391849529780564, 0.25705329153605017, 0.2601880877742947, 0.26332288401253917, 0.26489028213166144, 0.26959247648902823, 0.2711598746081505, 0.2774294670846395, 0.27899686520376177, 0.28213166144200624, 0.2836990595611285, 0.28683385579937304, 0.29153605015673983, 0.2962382445141066, 0.2993730407523511, 0.30407523510971785, 0.3072100313479624, 0.30877742946708464, 0.31191222570532917, 0.3166144200626959, 0.31974921630094044, 0.329153605015674, 0.3338557993730408, 0.33699059561128525, 0.3385579937304075, 0.3432601880877743, 0.3463949843260188, 0.3510971786833856, 0.3573667711598746, 0.3605015673981191, 0.3620689655172414, 0.3667711598746082, 0.3761755485893417, 0.3793103448275862, 0.39184952978056425, 0.3949843260188088, 0.39655172413793105, 0.3996865203761755, 0.40282131661442006, 0.4059561128526646, 0.42476489028213166, 0.42946708463949845, 0.4341692789968652, 0.4373040752351097, 0.44200626959247646, 0.445141065830721, 0.45768025078369906, 0.46238244514106586, 0.47335423197492166, 0.47962382445141066, 0.4890282131661442, 0.49216300940438873, 0.4952978056426332, 0.49843260188087773, 0.5015673981191222, 0.5062695924764891, 0.5141065830721003, 0.5172413793103449, 0.5642633228840125, 0.567398119122257, 0.5799373040752351, 0.5830721003134797, 0.9592476489028213, 0.9592476489028213, 0.9623824451410659, 0.9623824451410659, 0.9811912225705329, 0.9811912225705329, 0.9827586206896551, 0.9827586206896551, 0.9858934169278997, 0.9858934169278997, 0.9890282131661442, 0.9890282131661442, 0.9905956112852664, 0.9905956112852664, 0.9921630094043887, 0.9921630094043887, 0.9937304075235109, 0.9937304075235109, 0.9952978056426333, 0.9952978056426333, 0.9968652037617555, 0.9968652037617555, 0.9984326018808778, 0.9984326018808778, 1.0, 1.0],
                     [0.9973052939463903]]

    # stats dnn
    stats_dnn = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0064794816414686825, 0.0064794816414686825, 0.008639308855291577, 0.008639308855291577, 0.02159827213822894, 0.02159827213822894, 0.058315334773218146, 0.058315334773218146, 0.2526997840172786, 0.2526997840172786, 0.45788336933045354, 0.45788336933045354, 1.0],
                 [0.0, 0.004709576138147566, 0.007849293563579277, 0.012558869701726845, 0.015698587127158554, 0.01726844583987441, 0.023547880690737835, 0.029827315541601257, 0.03924646781789639, 0.04081632653061224, 0.04395604395604396, 0.04866562009419152, 0.058084772370486655, 0.061224489795918366, 0.06279434850863422, 0.06750392464678179, 0.06907378335949764, 0.07221350078492936, 0.07692307692307693, 0.08006279434850863, 0.08163265306122448, 0.09105180533751962, 0.09419152276295134, 0.0989010989010989, 0.10204081632653061, 0.1130298273155416, 0.11616954474097331, 0.12087912087912088, 0.12401883830455258, 0.12872841444270017, 0.130298273155416, 0.13343799058084774, 0.13500784929356358, 0.14285714285714285, 0.14442700156985872, 0.14756671899529042, 0.15070643642072212, 0.15698587127158556, 0.16012558869701726, 0.16326530612244897, 0.1664050235478807, 0.1695447409733124, 0.1726844583987441, 0.17739403453689168, 0.17896389324960754, 0.18210361067503925, 0.18681318681318682, 0.19152276295133439, 0.1978021978021978, 0.20251177394034536, 0.20565149136577707, 0.2087912087912088, 0.21036106750392464, 0.21664050235478807, 0.22291993720565148, 0.2260596546310832, 0.23390894819466249, 0.2401883830455259, 0.24175824175824176, 0.2543171114599686, 0.26373626373626374, 0.2668759811616955, 0.27001569858712715, 0.2731554160125589, 0.28100470957613816, 0.28414442700156983, 0.29513343799058084, 0.29827315541601257, 0.3029827315541601, 0.3092621664050236, 0.3218210361067504, 0.3249607535321821, 0.32967032967032966, 0.33437990580847726, 0.3814756671899529, 0.38461538461538464, 0.4065934065934066, 0.4097331240188383, 0.41444270015698587, 0.4175824175824176, 0.434850863422292, 0.4379905808477237, 0.4772370486656201, 0.4803767660910518, 0.48822605965463106, 0.4913657770800628, 0.5070643642072213, 0.5102040816326531, 0.5290423861852434, 0.5321821036106751, 0.533751962323391, 0.5368916797488226, 0.5949764521193093, 0.598116169544741, 0.6043956043956044, 0.6075353218210361, 0.9874411302982732, 0.9874411302982732, 0.9905808477237049, 0.9905808477237049, 0.9937205651491365, 0.9937205651491365, 0.9952904238618524, 0.9952904238618524, 0.9968602825745683, 0.9968602825745683, 0.9984301412872841, 0.9984301412872841, 1.0, 1.0],
                 [0.9987115630435592]]


    content_stats_bigru_fpr = np.array(content_stats_bigru[0])
    content_stats_bigru_tpr = np.array(content_stats_bigru[1])
    content_stats_bigru_roc_auc = content_stats_bigru[2][0]

    content_bigru_fpr = np.array(content_bigru[0])
    content_bigru_tpr = np.array(content_bigru[1])
    content_bigru_roc_auc = content_bigru[2][0]

    stats_dnn_fpr = np.array(stats_dnn[0])
    stats_dnn_tpr = np.array(stats_dnn[1])
    stats_dnn_roc_auc = stats_dnn[2][0]


    #开始画ROC曲线
    lw = 1.5
    plt.plot(content_stats_bigru_fpr, content_stats_bigru_tpr, 
            color='#FF8C00', linestyle='-', lw=lw, label='Content+stats BiGRU (AUC = %0.4f)'% content_stats_bigru_roc_auc)
    plt.plot(content_bigru_fpr, content_bigru_tpr, 
            color='#A52A2A', linestyle='--', lw=lw,label='Content BiGRU (AUC = %0.4f)'% content_bigru_roc_auc)
    plt.plot(stats_dnn_fpr, stats_dnn_tpr, 
            color='#ADFF2F', linestyle='-', lw=lw,label='Stats DNN (AUC = %0.4f)'% stats_dnn_roc_auc)
    plt.legend(loc='lower right')
    plt.plot([0,1],[0,1],color='#191970', linestyle='--')
    plt.xlim([-0.1,1.1])
    plt.ylim([-0.1,1.1])
    plt.xlabel('False Positive Rate') #横坐标是fpr
    plt.ylabel('True Positive Rate')  #纵坐标是tpr
    plt.title('Receiver operating characteristic')
    plt.show()
