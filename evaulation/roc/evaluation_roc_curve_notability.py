# coding='UTF-8'
import io
import sys
import os
import re
import pandas as pd
import nltk
import nltk.data
import numpy as np
import tensorflow
import keras
from keras import regularizers, optimizers
from keras import backend as K
from keras.callbacks import TensorBoard
from keras.engine.topology import Layer
from keras.models import Model, Sequential
from keras.layers import Input, Dense, LSTM, Bidirectional, Flatten, Dropout, Multiply, Permute, concatenate
from keras.utils import np_utils
from keras.optimizers import Adam
from sklearn import preprocessing
from sklearn.model_selection import train_test_split, StratifiedKFold
from sklearn.metrics import roc_curve, auc

from keras.callbacks import ReduceLROnPlateau
import matplotlib.pyplot as plt

if __name__ == '__main__':
    # roc values get from the training model

    ### Notability  FPR, TPR, auc
    # content+stats bigru
    content_stats_bigru = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0021598272138228943, 0.0021598272138228943, 0.008639308855291577, 0.008639308855291577, 0.5593952483801296, 0.5593952483801296, 1.0],
                           [0.0, 0.1006060606060606, 0.19636363636363635, 0.2690909090909091, 0.31636363636363635, 0.35393939393939394, 0.3709090909090909, 0.38666666666666666, 0.4072727272727273, 0.4254545454545455, 0.44727272727272727, 0.45696969696969697, 0.4690909090909091, 0.48, 0.49333333333333335, 0.5127272727272727, 0.52, 0.526060606060606, 0.5296969696969697, 0.5345454545454545, 0.5442424242424242, 0.5466666666666666, 0.5478787878787879, 0.553939393939394, 0.5684848484848485, 0.5721212121212121, 0.5781818181818181, 0.5806060606060606, 0.5842424242424242, 0.5890909090909091, 0.5915151515151515, 0.5951515151515151, 0.5975757575757575, 0.6, 0.6036363636363636, 0.6060606060606061, 0.610909090909091, 0.6157575757575757, 0.623030303030303, 0.6303030303030303, 0.6339393939393939, 0.6375757575757576, 0.64, 0.6496969696969697, 0.6509090909090909, 0.6533333333333333, 0.6606060606060606, 0.6630303030303031, 0.6666666666666666, 0.6715151515151515, 0.6727272727272727, 0.6775757575757576, 0.7054545454545454, 0.7078787878787879, 0.7103030303030303, 0.7127272727272728, 0.7490909090909091, 0.7539393939393939, 0.7551515151515151, 0.7575757575757576, 0.7587878787878788, 0.7636363636363637, 0.7830303030303031, 0.7866666666666666, 0.8072727272727273, 0.8096969696969697, 0.8909090909090909, 0.8933333333333333, 0.9163636363636364, 0.9187878787878788, 0.9951515151515151, 0.9951515151515151, 0.9975757575757576, 0.9975757575757576, 0.9987878787878788, 0.9987878787878788, 1.0, 1.0],
                           [0.9993062373191963]]

    # content bigru
    content_bigru = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0021598272138228943, 0.0021598272138228943, 0.004319654427645789, 0.004319654427645789, 0.0064794816414686825, 0.0064794816414686825, 0.008639308855291577, 0.008639308855291577, 0.012958963282937365, 0.012958963282937365, 0.42332613390928725, 0.42332613390928725, 1.0],
                     [0.0, 0.0012121212121212121, 0.02909090909090909, 0.03151515151515152, 0.07272727272727272, 0.07757575757575758, 0.08242424242424243, 0.08484848484848485, 0.10666666666666667, 0.10909090909090909, 0.12, 0.12242424242424242, 0.14666666666666667, 0.14909090909090908, 0.1503030303030303, 0.15272727272727274, 0.20606060606060606, 0.2084848484848485, 0.21454545454545454, 0.2193939393939394, 0.22181818181818183, 0.22424242424242424, 0.23515151515151514, 0.2387878787878788, 0.2896969696969697, 0.2921212121212121, 0.31636363636363635, 0.3187878787878788, 0.32606060606060605, 0.3284848484848485, 0.3321212121212121, 0.33454545454545453, 0.33575757575757575, 0.3406060606060606, 0.3418181818181818, 0.34545454545454546, 0.3466666666666667, 0.3490909090909091, 0.3527272727272727, 0.35515151515151516, 0.3575757575757576, 0.36, 0.36727272727272725, 0.3696969696969697, 0.37333333333333335, 0.37575757575757573, 0.3781818181818182, 0.3806060606060606, 0.38181818181818183, 0.3842424242424242, 0.3890909090909091, 0.39151515151515154, 0.3939393939393939, 0.3975757575757576, 0.3987878787878788, 0.4012121212121212, 0.4024242424242424, 0.40969696969696967, 0.4121212121212121, 0.41454545454545455, 0.41575757575757577, 0.41818181818181815, 0.4193939393939394, 0.4218181818181818, 0.42787878787878786, 0.4303030303030303, 0.4351515151515152, 0.43757575757575756, 0.4387878787878788, 0.4412121212121212, 0.44727272727272727, 0.45212121212121215, 0.45575757575757575, 0.45696969696969697, 0.4618181818181818, 0.4690909090909091, 0.4715151515151515, 0.4763636363636364, 0.47878787878787876, 0.48848484848484847, 0.4909090909090909, 0.4921212121212121, 0.49454545454545457, 0.5115151515151515, 0.5151515151515151, 0.5175757575757576, 0.5224242424242425, 0.5248484848484849, 0.526060606060606, 0.5284848484848484, 0.5466666666666666, 0.5490909090909091, 0.5515151515151515, 0.553939393939394, 0.5648484848484848, 0.5672727272727273, 0.5854545454545454, 0.5878787878787879, 0.5963636363636363, 0.5987878787878788, 0.6024242424242424, 0.6048484848484849, 0.610909090909091, 0.6133333333333333, 0.623030303030303, 0.6254545454545455, 0.6327272727272727, 0.6351515151515151, 0.6436363636363637, 0.6472727272727272, 0.6557575757575758, 0.6581818181818182, 0.6678787878787878, 0.6703030303030303, 0.6715151515151515, 0.673939393939394, 0.6945454545454546, 0.696969696969697, 0.7163636363636363, 0.7187878787878788, 0.72, 0.7224242424242424, 0.7515151515151515, 0.7539393939393939, 0.7648484848484849, 0.7672727272727272, 0.7733333333333333, 0.7757575757575758, 0.7915151515151515, 0.793939393939394, 0.8109090909090909, 0.8133333333333334, 0.8436363636363636, 0.8460606060606061, 0.8557575757575757, 0.8581818181818182, 0.9066666666666666, 0.9090909090909091, 0.9793939393939394, 0.9793939393939394, 0.9818181818181818, 0.9818181818181818, 0.9903030303030304, 0.9903030303030304, 0.9951515151515151, 0.9951515151515151, 0.9975757575757576, 0.9975757575757576, 0.9987878787878788, 0.9987878787878788, 1.0, 1.0],
                     [0.9993769225734668]]

    # stats dnn
    stats_dnn = [[0.0, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.0064794816414686825, 0.0064794816414686825, 0.008639308855291577, 0.008639308855291577, 0.058315334773218146, 0.058315334773218146, 1.0],
                 [0.0, 0.21212121212121213, 0.3006060606060606, 0.3490909090909091, 0.3903030303030303, 0.41575757575757577, 0.4387878787878788, 0.4581818181818182, 0.4763636363636364, 0.4909090909090909, 0.4993939393939394, 0.5115151515151515, 0.5284848484848484, 0.5357575757575758, 0.5418181818181819, 0.5490909090909091, 0.553939393939394, 0.5612121212121212, 0.566060606060606, 0.5781818181818181, 0.5818181818181818, 0.5890909090909091, 0.5927272727272728, 0.593939393939394, 0.5987878787878788, 0.6012121212121212, 0.6048484848484849, 0.610909090909091, 0.6145454545454545, 0.6266666666666667, 0.6290909090909091, 0.6339393939393939, 0.6363636363636364, 0.6412121212121212, 0.6436363636363637, 0.6472727272727272, 0.6496969696969697, 0.6509090909090909, 0.6581818181818182, 0.6593939393939394, 0.6618181818181819, 0.6654545454545454, 0.6678787878787878, 0.6775757575757576, 0.6787878787878788, 0.6824242424242424, 0.6836363636363636, 0.6872727272727273, 0.6909090909090909, 0.6933333333333334, 0.6957575757575758, 0.6981818181818182, 0.703030303030303, 0.7054545454545454, 0.7066666666666667, 0.7090909090909091, 0.7151515151515152, 0.7175757575757575, 0.72, 0.7224242424242424, 0.7284848484848485, 0.730909090909091, 0.7321212121212122, 0.7345454545454545, 0.7369696969696969, 0.7393939393939394, 0.7454545454545455, 0.7478787878787879, 0.7563636363636363, 0.76, 0.7684848484848484, 0.7733333333333333, 0.776969696969697, 0.7793939393939394, 0.7806060606060606, 0.7830303030303031, 0.7866666666666666, 0.7890909090909091, 0.7915151515151515, 0.793939393939394, 0.7975757575757576, 0.8, 0.8581818181818182, 0.8606060606060606, 0.8775757575757576, 0.88, 0.9672727272727273, 0.9672727272727273, 0.9842424242424243, 0.9842424242424243, 0.9987878787878788, 0.9987878787878788, 1.0, 1.0],
                 [0.9966149617121539]]


    content_stats_bigru_fpr = np.array(content_stats_bigru[0])
    content_stats_bigru_tpr = np.array(content_stats_bigru[1])
    content_stats_bigru_roc_auc = content_stats_bigru[2][0]

    content_bigru_fpr = np.array(content_bigru[0])
    content_bigru_tpr = np.array(content_bigru[1])
    content_bigru_roc_auc = content_bigru[2][0]

    stats_dnn_fpr = np.array(stats_dnn[0])
    stats_dnn_tpr = np.array(stats_dnn[1])
    stats_dnn_roc_auc = stats_dnn[2][0]


    #开始画ROC曲线
    lw = 1.5
    plt.plot(content_stats_bigru_fpr, content_stats_bigru_tpr, 
            color='#FF8C00', linestyle='-', lw=lw, label='Content+stats BiGRU (AUC = %0.4f)'% content_stats_bigru_roc_auc)
    plt.plot(content_bigru_fpr, content_bigru_tpr, 
            color='#A52A2A', linestyle='--', lw=lw,label='Content BiGRU (AUC = %0.4f)'% content_bigru_roc_auc)
    plt.plot(stats_dnn_fpr, stats_dnn_tpr, 
            color='#ADFF2F', linestyle='-', lw=lw,label='Stats DNN (AUC = %0.4f)'% stats_dnn_roc_auc)
    plt.legend(loc='lower right')
    plt.plot([0,1],[0,1],color='#191970', linestyle='--')
    plt.xlim([-0.1,1.1])
    plt.ylim([-0.1,1.1])
    plt.xlabel('False Positive Rate') #横坐标是fpr
    plt.ylabel('True Positive Rate')  #纵坐标是tpr
    plt.title('Receiver operating characteristic')
    plt.show()
