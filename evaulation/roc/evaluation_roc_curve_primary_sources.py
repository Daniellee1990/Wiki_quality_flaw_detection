# coding='UTF-8'
import io
import sys
import os
import re
import pandas as pd
import nltk
import nltk.data
import numpy as np
import tensorflow
import keras
from keras import regularizers, optimizers
from keras import backend as K
from keras.callbacks import TensorBoard
from keras.engine.topology import Layer
from keras.models import Model, Sequential
from keras.layers import Input, Dense, LSTM, Bidirectional, Flatten, Dropout, Multiply, Permute, concatenate
from keras.utils import np_utils
from keras.optimizers import Adam
from sklearn import preprocessing
from sklearn.model_selection import train_test_split, StratifiedKFold
from sklearn.metrics import roc_curve, auc

from keras.callbacks import ReduceLROnPlateau
import matplotlib.pyplot as plt

if __name__ == '__main__':
    # roc values get from the training model

    ### Primary sources  FPR, TPR, auc
    # content+stats bigru
    content_stats_bigru = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0021598272138228943, 0.0021598272138228943, 0.004319654427645789, 0.004319654427645789, 0.0064794816414686825, 0.0064794816414686825, 0.008639308855291577, 0.008639308855291577, 0.01079913606911447, 0.01079913606911447, 0.012958963282937365, 0.012958963282937365, 0.017278617710583154, 0.017278617710583154, 0.023758099352051837, 0.023758099352051837, 0.038876889848812095, 0.038876889848812095, 0.07775377969762419, 0.07775377969762419, 0.08207343412526998, 0.08207343412526998, 0.08423326133909287, 0.08423326133909287, 0.17494600431965443, 0.17494600431965443, 0.3023758099352052, 0.3023758099352052, 1.0],
                           [0.0, 0.012113055181695828, 0.018842530282637954, 0.024226110363391656, 0.03230148048452221, 0.04845222072678331, 0.05652759084791386, 0.05787348586810229, 0.06864064602960969, 0.07133243606998654, 0.07537012113055182, 0.08075370121130551, 0.08882907133243607, 0.09152086137281291, 0.09690444145356662, 0.1063257065948856, 0.11036339165545088, 0.11709286675639301, 0.11978465679676985, 0.12382234185733512, 0.12516823687752354, 0.1278600269179004, 0.13593539703903096, 0.14131897711978467, 0.14670255720053835, 0.15074024226110364, 0.15208613728129206, 0.15612382234185734, 0.15746971736204576, 0.1601615074024226, 0.1655450874831763, 0.1695827725437416, 0.17227456258411844, 0.17900403768506057, 0.18977119784656796, 0.1911170928667564, 0.19515477792732167, 0.19650067294751009, 0.2072678331090175, 0.20861372812920592, 0.21534320323014805, 0.2193808882907133, 0.22207267833109018, 0.22476446837146702, 0.2274562584118439, 0.23553162853297444, 0.23687752355316286, 0.2395693135935397, 0.2449528936742934, 0.24764468371467024, 0.2489905787348587, 0.25168236877523553, 0.2557200538358008, 0.2691790040376851, 0.2718707940780619, 0.2759084791386272, 0.27994616419919244, 0.28263795423956933, 0.2839838492597577, 0.29475100942126514, 0.30148048452220727, 0.3041722745625841, 0.31090174966352624, 0.3135935397039031, 0.32166890982503366, 0.32705248990578734, 0.3297442799461642, 0.3351278600269179, 0.3405114401076716, 0.34320323014804843, 0.351278600269179, 0.35397039030955585, 0.3674293405114401, 0.37012113055181695, 0.3714670255720054, 0.37415881561238223, 0.38627187079407804, 0.38896366083445494, 0.3997308209959623, 0.40242261103633914, 0.4158815612382234, 0.4185733512786003, 0.4306864064602961, 0.43337819650067294, 0.44818304172274565, 0.4535666218034993, 0.45625841184387617, 0.458950201884253, 0.4831763122476447, 0.48855989232839836, 0.5154777927321669, 0.5181695827725438, 0.5518169582772544, 0.5545087483176312, 0.566621803499327, 0.5693135935397039, 0.6635262449528937, 0.6662180349932705, 0.6796769851951547, 0.6823687752355316, 0.9609690444145357, 0.9609690444145357, 0.9650067294751009, 0.9650067294751009, 0.9744279946164199, 0.9744279946164199, 0.9784656796769852, 0.9784656796769852, 0.9838492597577388, 0.9838492597577388, 0.9865410497981157, 0.9865410497981157, 0.9878869448183042, 0.9878869448183042, 0.9892328398384926, 0.9892328398384926, 0.990578734858681, 0.990578734858681, 0.9919246298788694, 0.9919246298788694, 0.9932705248990579, 0.9932705248990579, 0.9946164199192463, 0.9946164199192463, 0.9973082099596231, 0.9973082099596231, 0.9986541049798116, 0.9986541049798116, 1.0, 1.0],
                           [0.9986395704763538]]

    # content bigru
    content_bigru = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.0021598272138228943, 0.004319654427645789, 0.004319654427645789, 0.0064794816414686825, 0.0064794816414686825, 0.008639308855291577, 0.008639308855291577, 0.01079913606911447, 0.01079913606911447, 0.012958963282937365, 0.012958963282937365, 0.01511879049676026, 0.01511879049676026, 0.017278617710583154, 0.017278617710583154, 0.019438444924406047, 0.019438444924406047, 0.023758099352051837, 0.023758099352051837, 0.02591792656587473, 0.02591792656587473, 0.032397408207343416, 0.032397408207343416, 0.04103671706263499, 0.04103671706263499, 0.04319654427645788, 0.04319654427645788, 0.04535637149028078, 0.04535637149028078, 0.047516198704103674, 0.047516198704103674, 0.06695464362850972, 0.06695464362850972, 0.06911447084233262, 0.06911447084233262, 0.07127429805615551, 0.07127429805615551, 0.08855291576673865, 0.08855291576673865, 0.09071274298056156, 0.09071274298056156, 0.1447084233261339, 0.1447084233261339, 0.15334773218142547, 0.15334773218142547, 0.19222462203023757, 0.19222462203023757, 1.0],
                     [0.0, 0.0013458950201884253, 0.009421265141318977, 0.012113055181695828, 0.014804845222072678, 0.017496635262449527, 0.021534320323014805, 0.024226110363391656, 0.04845222072678331, 0.05114401076716016, 0.059219380888290714, 0.06191117092866756, 0.06460296096904442, 0.06729475100942127, 0.06864064602960969, 0.07267833109017496, 0.07806191117092867, 0.08075370121130551, 0.08209959623149395, 0.0847913862718708, 0.08882907133243607, 0.09286675639300135, 0.0955585464333782, 0.09825033647375504, 0.09959623149394348, 0.10767160161507403, 0.11036339165545088, 0.11305518169582772, 0.11843876177658143, 0.12113055181695828, 0.1224764468371467, 0.1278600269179004, 0.12920592193808883, 0.13324360699865412, 0.14131897711978467, 0.1440107671601615, 0.14535666218034993, 0.1480484522207268, 0.15074024226110364, 0.15612382234185734, 0.15746971736204576, 0.1601615074024226, 0.16150740242261102, 0.16689098250336473, 0.1695827725437416, 0.17092866756393002, 0.17362045760430686, 0.180349932705249, 0.18304172274562583, 0.18438761776581428, 0.19246298788694483, 0.19650067294751009, 0.19784656796769853, 0.2032301480484522, 0.21130551816958276, 0.21399730820995963, 0.2180349932705249, 0.2234185733512786, 0.23822341857335128, 0.24091520861372812, 0.24226110363391656, 0.24629878869448182, 0.2489905787348587, 0.25168236877523553, 0.25841184387617766, 0.26244952893674295, 0.2651413189771198, 0.2691790040376851, 0.2718707940780619, 0.2732166890982503, 0.2759084791386272, 0.2812920592193809, 0.2839838492597577, 0.28936742934051146, 0.2920592193808883, 0.30148048452220727, 0.3041722745625841, 0.3351278600269179, 0.33781965006729475, 0.3445491251682369, 0.34993270524899056, 0.351278600269179, 0.35397039030955585, 0.36877523553162855, 0.3714670255720054, 0.3728129205921938, 0.3781965006729475, 0.4158815612382234, 0.4185733512786003, 0.4199192462987887, 0.4226110363391655, 0.4253028263795424, 0.42799461641991926, 0.4347240915208614, 0.43741588156123823, 0.4414535666218035, 0.44549125168236875, 0.44818304172274565, 0.4508748317631225, 0.4535666218034993, 0.46029609690444145, 0.46433378196500674, 0.4791386271870794, 0.48183041722745623, 0.4845222072678331, 0.48855989232839836, 0.5248990578734859, 0.5275908479138627, 0.5518169582772544, 0.5558546433378196, 0.5720053835800808, 0.5720053835800808, 0.576043068640646, 0.5787348586810229, 0.5881561238223418, 0.5935397039030955, 0.6325706594885598, 0.6379542395693136, 0.7671601615074024, 0.7698519515477793, 0.8263795423956931, 0.82907133243607, 0.8761776581426649, 0.8761776581426649, 0.9421265141318977, 0.9421265141318977, 0.946164199192463, 0.946164199192463, 0.9488559892328399, 0.9488559892328399, 0.9569313593539704, 0.9569313593539704, 0.9623149394347241, 0.9623149394347241, 0.9636608344549125, 0.9636608344549125, 0.9676985195154778, 0.9676985195154778, 0.9703903095558546, 0.9703903095558546, 0.9730820995962315, 0.9730820995962315, 0.9798115746971736, 0.9798115746971736, 0.9811574697173621, 0.9811574697173621, 0.9825033647375505, 0.9825033647375505, 0.9838492597577388, 0.9838492597577388, 0.9865410497981157, 0.9865410497981157, 0.9878869448183042, 0.9878869448183042, 0.9892328398384926, 0.9892328398384926, 0.990578734858681, 0.990578734858681, 0.9919246298788694, 0.9919246298788694, 0.9932705248990579, 0.9932705248990579, 0.9959623149394348, 0.9959623149394348, 0.9973082099596231, 0.9973082099596231, 0.9986541049798116, 0.9986541049798116, 1.0, 1.0],
                     [0.9968256644448256]]

    # stats dnn
    stats_dnn = [[0.0, 0.0021598272138228943, 0.0021598272138228943, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.004319654427645789, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.0064794816414686825, 0.008639308855291577, 0.008639308855291577, 0.01079913606911447, 0.01079913606911447, 0.012958963282937365, 0.012958963282937365, 0.01511879049676026, 0.01511879049676026, 0.017278617710583154, 0.017278617710583154, 0.019438444924406047, 0.019438444924406047, 0.02159827213822894, 0.02159827213822894, 0.023758099352051837, 0.023758099352051837, 0.03023758099352052, 0.03023758099352052, 0.032397408207343416, 0.032397408207343416, 0.0367170626349892, 0.0367170626349892, 0.04103671706263499, 0.04103671706263499, 0.04535637149028078, 0.04535637149028078, 0.04967602591792657, 0.04967602591792657, 0.05399568034557235, 0.05399568034557235, 0.058315334773218146, 0.058315334773218146, 0.06695464362850972, 0.06695464362850972, 0.0755939524838013, 0.0755939524838013, 0.09503239740820735, 0.09503239740820735, 0.10583153347732181, 0.10583153347732181, 0.15334773218142547, 0.15334773218142547, 0.2505399568034557, 0.2505399568034557, 0.2786177105831533, 0.2786177105831533, 0.6587473002159827, 0.6587473002159827, 1.0],
                 [0.0, 0.12920592193808883, 0.1695827725437416, 0.2032301480484522, 0.2126514131897712, 0.23418573351278602, 0.25168236877523553, 0.26244952893674295, 0.27052489905787347, 0.28667563930013457, 0.29878869448183043, 0.30686406460296095, 0.31090174966352624, 0.32705248990578734, 0.33378196500672946, 0.33781965006729475, 0.3405114401076716, 0.34993270524899056, 0.35262449528936746, 0.3566621803499327, 0.3620457604306864, 0.3633916554508748, 0.36608344549125166, 0.3674293405114401, 0.3714670255720054, 0.3728129205921938, 0.3755047106325707, 0.3768506056527591, 0.38088829071332436, 0.3835800807537012, 0.3876177658142665, 0.39030955585464333, 0.39569313593539707, 0.3997308209959623, 0.4037685060565276, 0.4064602960969044, 0.414535666218035, 0.41722745625841184, 0.4253028263795424, 0.42799461641991926, 0.42934051144010765, 0.42934051144010765, 0.43337819650067294, 0.4387617765814266, 0.4414535666218035, 0.4468371467025572, 0.44818304172274565, 0.4535666218034993, 0.45625841184387617, 0.458950201884253, 0.46433378196500674, 0.46567967698519513, 0.4737550471063257, 0.47644683714670255, 0.4791386271870794, 0.4845222072678331, 0.48721399730820997, 0.49125168236877526, 0.49663526244952894, 0.5006729475100942, 0.5033647375504711, 0.5047106325706595, 0.5087483176312247, 0.5114401076716016, 0.5127860026917901, 0.5154777927321669, 0.5248990578734859, 0.5275908479138627, 0.5437415881561238, 0.5491251682368775, 0.5518169582772544, 0.5545087483176312, 0.5814266487213997, 0.5868102288021534, 0.5895020188425303, 0.5921938088829072, 0.6069986541049798, 0.6096904441453567, 0.7927321668909825, 0.7927321668909825, 0.9232839838492598, 0.9232839838492598, 0.9475100942126514, 0.9475100942126514, 0.9582772543741588, 0.9582772543741588, 0.9609690444145357, 0.9609690444145357, 0.9650067294751009, 0.9650067294751009, 0.9744279946164199, 0.9744279946164199, 0.9757738896366084, 0.9757738896366084, 0.9784656796769852, 0.9784656796769852, 0.9798115746971736, 0.9798115746971736, 0.9811574697173621, 0.9811574697173621, 0.9825033647375505, 0.9825033647375505, 0.9838492597577388, 0.9838492597577388, 0.9851951547779273, 0.9851951547779273, 0.9865410497981157, 0.9865410497981157, 0.9878869448183042, 0.9878869448183042, 0.9892328398384926, 0.9892328398384926, 0.990578734858681, 0.990578734858681, 0.9919246298788694, 0.9919246298788694, 0.9932705248990579, 0.9932705248990579, 0.9946164199192463, 0.9946164199192463, 0.9959623149394348, 0.9959623149394348, 0.9973082099596231, 0.9973082099596231, 0.9986541049798116, 0.9986541049798116, 1.0, 1.0],
                 [0.9916819036711249]]


    content_stats_bigru_fpr = np.array(content_stats_bigru[0])
    content_stats_bigru_tpr = np.array(content_stats_bigru[1])
    content_stats_bigru_roc_auc = content_stats_bigru[2][0]

    content_bigru_fpr = np.array(content_bigru[0])
    content_bigru_tpr = np.array(content_bigru[1])
    content_bigru_roc_auc = content_bigru[2][0]

    stats_dnn_fpr = np.array(stats_dnn[0])
    stats_dnn_tpr = np.array(stats_dnn[1])
    stats_dnn_roc_auc = stats_dnn[2][0]


    #开始画ROC曲线
    lw = 1.5
    plt.plot(content_stats_bigru_fpr, content_stats_bigru_tpr, 
            color='#FF8C00', linestyle='-', lw=lw, label='Content+stats BiGRU (AUC = %0.4f)'% content_stats_bigru_roc_auc)
    plt.plot(content_bigru_fpr, content_bigru_tpr, 
            color='#A52A2A', linestyle='--', lw=lw,label='Content BiGRU (AUC = %0.4f)'% content_bigru_roc_auc)
    plt.plot(stats_dnn_fpr, stats_dnn_tpr, 
            color='#ADFF2F', linestyle='-', lw=lw,label='Stats DNN (AUC = %0.4f)'% stats_dnn_roc_auc)
    plt.legend(loc='lower right')
    plt.plot([0,1],[0,1],color='#191970', linestyle='--')
    plt.xlim([-0.1,1.1])
    plt.ylim([-0.1,1.1])
    plt.xlabel('False Positive Rate') #横坐标是fpr
    plt.ylabel('True Positive Rate')  #纵坐标是tpr
    plt.title('Receiver operating characteristic')
    plt.show()
